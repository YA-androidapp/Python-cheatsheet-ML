### 時系列データのグループ化

```py
import datetime
import numpy as np
import pandas as pd

start_date = datetime.datetime(2020, 6, 1)
days = 365
ncol = 10
df = pd.DataFrame(np.arange(days * ncol).reshape(days, ncol), index=pd.Index([start_date + datetime.timedelta(days=x) for x in range(days)], name = 'index'), columns=pd.Index(['c{}'.format(x+1) for x in range(ncol)], name= 'column'))

# A: 年
df.resample(rule='A').min()

# Q: 四半期
df.resample(rule='Q').median()

# M: 月
round(df.resample(rule='M').mean())

# W: 週
df.resample(rule='W').sum().head()

# 先頭の値
df.resample('Q', label='left', closed='left').first()
df.resample('Q', label='right', closed='right').first()

# 末尾の値
df.resample('M').last()

# 個数
df.resample('M').count()

# OHLC（Open: 始値、High: 高値、Low: 安値、Close: 終値）
df.resample('M').ohlc()
```

```
# A: 年

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-12-31     0     1     2     3     4     5     6     7     8     9
2021-12-31  2140  2141  2142  2143  2144  2145  2146  2147  2148  2149


# Q: 四半期

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-30   145   146   147   148   149   150   151   152   153   154
2020-09-30   755   756   757   758   759   760   761   762   763   764
2020-12-31  1675  1676  1677  1678  1679  1680  1681  1682  1683  1684
2021-03-31  2585  2586  2587  2588  2589  2590  2591  2592  2593  2594
2021-06-30  3340  3341  3342  3343  3344  3345  3346  3347  3348  3349


# M: 月

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-30   145   146   147   148   149   150   151   152   153   154
2020-07-31   450   451   452   453   454   455   456   457   458   459
2020-08-31   760   761   762   763   764   765   766   767   768   769
2020-09-30  1065  1066  1067  1068  1069  1070  1071  1072  1073  1074
2020-10-31  1370  1371  1372  1373  1374  1375  1376  1377  1378  1379
2020-11-30  1675  1676  1677  1678  1679  1680  1681  1682  1683  1684
2020-12-31  1980  1981  1982  1983  1984  1985  1986  1987  1988  1989
2021-01-31  2290  2291  2292  2293  2294  2295  2296  2297  2298  2299
2021-02-28  2585  2586  2587  2588  2589  2590  2591  2592  2593  2594
2021-03-31  2880  2881  2882  2883  2884  2885  2886  2887  2888  2889
2021-04-30  3185  3186  3187  3188  3189  3190  3191  3192  3193  3194
2021-05-31  3490  3491  3492  3493  3494  3495  3496  3497  3498  3499


# W: 週

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-07   210   217   224   231   238   245   252   259   266   273
2020-06-14   700   707   714   721   728   735   742   749   756   763
2020-06-21  1190  1197  1204  1211  1218  1225  1232  1239  1246  1253
2020-06-28  1680  1687  1694  1701  1708  1715  1722  1729  1736  1743
2020-07-05  2170  2177  2184  2191  2198  2205  2212  2219  2226  2233


# 先頭の値

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-30     0     1     2     3     4     5     6     7     8     9
2020-09-30   300   301   302   303   304   305   306   307   308   309
2020-12-31  1220  1221  1222  1223  1224  1225  1226  1227  1228  1229
2021-03-31  2140  2141  2142  2143  2144  2145  2146  2147  2148  2149
2021-06-30  3040  3041  3042  3043  3044  3045  3046  3047  3048  3049

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-03-31     0     1     2     3     4     5     6     7     8     9
2020-06-30   290   291   292   293   294   295   296   297   298   299
2020-09-30  1210  1211  1212  1213  1214  1215  1216  1217  1218  1219
2020-12-31  2130  2131  2132  2133  2134  2135  2136  2137  2138  2139
2021-03-31  3030  3031  3032  3033  3034  3035  3036  3037  3038  3039

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-30     0     1     2     3     4     5     6     7     8     9
2020-09-30   300   301   302   303   304   305   306   307   308   309
2020-12-31  1220  1221  1222  1223  1224  1225  1226  1227  1228  1229
2021-03-31  2140  2141  2142  2143  2144  2145  2146  2147  2148  2149
2021-06-30  3040  3041  3042  3043  3044  3045  3046  3047  3048  3049



# 末尾の値

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-30   290   291   292   293   294   295   296   297   298   299
2020-07-31   600   601   602   603   604   605   606   607   608   609
2020-08-31   910   911   912   913   914   915   916   917   918   919
2020-09-30  1210  1211  1212  1213  1214  1215  1216  1217  1218  1219
2020-10-31  1520  1521  1522  1523  1524  1525  1526  1527  1528  1529
2020-11-30  1820  1821  1822  1823  1824  1825  1826  1827  1828  1829
2020-12-31  2130  2131  2132  2133  2134  2135  2136  2137  2138  2139
2021-01-31  2440  2441  2442  2443  2444  2445  2446  2447  2448  2449
2021-02-28  2720  2721  2722  2723  2724  2725  2726  2727  2728  2729
2021-03-31  3030  3031  3032  3033  3034  3035  3036  3037  3038  3039
2021-04-30  3330  3331  3332  3333  3334  3335  3336  3337  3338  3339
2021-05-31  3640  3641  3642  3643  3644  3645  3646  3647  3648  3649


# 個数

column      c1  c2  c3  c4  c5  c6  c7  c8  c9  c10
index
2020-06-30  30  30  30  30  30  30  30  30  30   30
2020-07-31  31  31  31  31  31  31  31  31  31   31
2020-08-31  31  31  31  31  31  31  31  31  31   31
2020-09-30  30  30  30  30  30  30  30  30  30   30
2020-10-31  31  31  31  31  31  31  31  31  31   31
2020-11-30  30  30  30  30  30  30  30  30  30   30
2020-12-31  31  31  31  31  31  31  31  31  31   31
2021-01-31  31  31  31  31  31  31  31  31  31   31
2021-02-28  28  28  28  28  28  28  28  28  28   28
2021-03-31  31  31  31  31  31  31  31  31  31   31
2021-04-30  30  30  30  30  30  30  30  30  30   30
2021-05-31  31  31  31  31  31  31  31  31  31   31


# OHLC（Open: 始値、High: 高値、Low: 安値、Close: 終値）

column        c1                      c2                      c3  ...    c8    c9                     c10
            open  high   low close  open  high   low close  open  ... close  open  high   low close  open  high   low close
index                                                             ...
2020-06-30     0   290     0   290     1   291     1   291     2  ...   297     8   298     8   298     9   299     9   299
2020-07-31   300   600   300   600   301   601   301   601   302  ...   607   308   608   308   608   309   609   309   609
2020-08-31   610   910   610   910   611   911   611   911   612  ...   917   618   918   618   918   619   919   619   919
2020-09-30   920  1210   920  1210   921  1211   921  1211   922  ...  1217   928  1218   928  1218   929  1219   929  1219
2020-10-31  1220  1520  1220  1520  1221  1521  1221  1521  1222  ...  1527  1228  1528  1228  1528  1229  1529  1229  1529
2020-11-30  1530  1820  1530  1820  1531  1821  1531  1821  1532  ...  1827  1538  1828  1538  1828  1539  1829  1539  1829
2020-12-31  1830  2130  1830  2130  1831  2131  1831  2131  1832  ...  2137  1838  2138  1838  2138  1839  2139  1839  2139
2021-01-31  2140  2440  2140  2440  2141  2441  2141  2441  2142  ...  2447  2148  2448  2148  2448  2149  2449  2149  2449
2021-02-28  2450  2720  2450  2720  2451  2721  2451  2721  2452  ...  2727  2458  2728  2458  2728  2459  2729  2459  2729
2021-03-31  2730  3030  2730  3030  2731  3031  2731  3031  2732  ...  3037  2738  3038  2738  3038  2739  3039  2739  3039
2021-04-30  3040  3330  3040  3330  3041  3331  3041  3331  3042  ...  3337  3048  3338  3048  3338  3049  3339  3049  3339
2021-05-31  3340  3640  3340  3640  3341  3641  3341  3641  3342  ...  3647  3348  3648  3348  3648  3349  3649  3349  3649

[12 rows x 40 columns]
```
