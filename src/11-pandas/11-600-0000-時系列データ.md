## 時系列データ

```py
import numpy as np
import pandas as pd

import datetime

start_date = datetime.datetime(2020, 6, 1)
days = 365
ncol = 10

arr = np.arange(days * ncol).reshape(days, ncol)
idx = pd.Index([start_date + datetime.timedelta(days=x) for x in range(days)], name = 'index')
col = pd.Index(['c{}'.format(x+1) for x in range(ncol)], name= 'column')
df = pd.DataFrame(arr, index=idx, columns=col)

# df
print(df.head())
print(df.tail())

# ラグ（下方向に1行）
print(df.shift(1).head())
print(df.shift(1).tail())

# ラグ（上方向に7行）
print(df.shift(-7).head())
print(df.shift(-7).tail())

# ラグ（3日）
print(df.shift(freq='3D'))
```

```
c4  c5  c6  c7  c8  c9  c10
index
2020-06-01   0   1   2   3   4   5   6   7   8    9
2020-06-02  10  11  12  13  14  15  16  17  18   19
2020-06-03  20  21  22  23  24  25  26  27  28   29
2020-06-04  30  31  32  33  34  35  36  37  38   39
2020-06-05  40  41  42  43  44  45  46  47  48   49

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2021-05-27  3600  3601  3602  3603  3604  3605  3606  3607  3608  3609
2021-05-28  3610  3611  3612  3613  3614  3615  3616  3617  3618  3619
2021-05-29  3620  3621  3622  3623  3624  3625  3626  3627  3628  3629
2021-05-30  3630  3631  3632  3633  3634  3635  3636  3637  3638  3639
2021-05-31  3640  3641  3642  3643  3644  3645  3646  3647  3648  3649

# ラグ（下方向に1行）
column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-01   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN   NaN
2020-06-02   0.0   1.0   2.0   3.0   4.0   5.0   6.0   7.0   8.0   9.0
2020-06-03  10.0  11.0  12.0  13.0  14.0  15.0  16.0  17.0  18.0  19.0
2020-06-04  20.0  21.0  22.0  23.0  24.0  25.0  26.0  27.0  28.0  29.0
2020-06-05  30.0  31.0  32.0  33.0  34.0  35.0  36.0  37.0  38.0  39.0

column          c1      c2      c3      c4      c5      c6      c7      c8      c9     c10
index
2021-05-27  3590.0  3591.0  3592.0  3593.0  3594.0  3595.0  3596.0  3597.0  3598.0  3599.0
2021-05-28  3600.0  3601.0  3602.0  3603.0  3604.0  3605.0  3606.0  3607.0  3608.0  3609.0
2021-05-29  3610.0  3611.0  3612.0  3613.0  3614.0  3615.0  3616.0  3617.0  3618.0  3619.0
2021-05-30  3620.0  3621.0  3622.0  3623.0  3624.0  3625.0  3626.0  3627.0  3628.0  3629.0
2021-05-31  3630.0  3631.0  3632.0  3633.0  3634.0  3635.0  3636.0  3637.0  3638.0  3639.0


# ラグ（上方向に7行）

column         c1     c2     c3     c4     c5     c6     c7     c8     c9    c10
index
2020-06-01   70.0   71.0   72.0   73.0   74.0   75.0   76.0   77.0   78.0   79.0
2020-06-02   80.0   81.0   82.0   83.0   84.0   85.0   86.0   87.0   88.0   89.0
2020-06-03   90.0   91.0   92.0   93.0   94.0   95.0   96.0   97.0   98.0   99.0
2020-06-04  100.0  101.0  102.0  103.0  104.0  105.0  106.0  107.0  108.0  109.0
2020-06-05  110.0  111.0  112.0  113.0  114.0  115.0  116.0  117.0  118.0  119.0

column      c1  c2  c3  c4  c5  c6  c7  c8  c9  c10
index
2021-05-27 NaN NaN NaN NaN NaN NaN NaN NaN NaN  NaN
2021-05-28 NaN NaN NaN NaN NaN NaN NaN NaN NaN  NaN
2021-05-29 NaN NaN NaN NaN NaN NaN NaN NaN NaN  NaN
2021-05-30 NaN NaN NaN NaN NaN NaN NaN NaN NaN  NaN
2021-05-31 NaN NaN NaN NaN NaN NaN NaN NaN NaN  NaN


# ラグ（3日）

column        c1    c2    c3    c4    c5    c6    c7    c8    c9   c10
index
2020-06-04     0     1     2     3     4     5     6     7     8     9
2020-06-05    10    11    12    13    14    15    16    17    18    19
2020-06-06    20    21    22    23    24    25    26    27    28    29
2020-06-07    30    31    32    33    34    35    36    37    38    39
2020-06-08    40    41    42    43    44    45    46    47    48    49
...          ...   ...   ...   ...   ...   ...   ...   ...   ...   ...
2021-05-30  3600  3601  3602  3603  3604  3605  3606  3607  3608  3609
2021-05-31  3610  3611  3612  3613  3614  3615  3616  3617  3618  3619
2021-06-01  3620  3621  3622  3623  3624  3625  3626  3627  3628  3629
2021-06-02  3630  3631  3632  3633  3634  3635  3636  3637  3638  3639
2021-06-03  3640  3641  3642  3643  3644  3645  3646  3647  3648  3649

[365 rows x 10 columns]
```
